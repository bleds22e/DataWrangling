---
title: 'Week 8: Solving Bigger Problems'
author: "Ellen Bledsoe"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Solving Bigger Problems

* Take a break learning commands to talk about general approaches
* Real computational tasks are complicated. To accomplish them you need to
  **think before you code**.

## Problem decomposition steps (10 minutes)

Open the following images one per tab and cycle through:
* <https://i.imgflip.com/80ul6w.jpg>
* <https://www.smarterandharder.com/wp-content/uploads/2021/02/breaking-down-problems-1024x683.jpg.webp>
* <https://thirdsectorlab.co.uk/wp-content/uploads/2021/06/How-do-you-eat-an-elephant.png>

1. Understand the problem
    1. Restate the problem in your own words
    2. Determine the inputs and outputs
    3. Ask for clarification
2. Break the problem down
    1.  Write down the pieces, on paper or as comments in a file
    2.  Break complicated pieces down until all pieces are small and manageable
3. Code one small piece at a time
    1.  Test it on it's own
    2.  Fix any problems before proceeding

### Breaking down an exercise (15 minutes)

* This week we will be working on more complex exercises
* Show end result of first exercise
* Take time 5 minutes to read through one of the exercises
* Then we'll try to break it down into pieces as a class

### Start simple

1. Experiment
2. Write a simpler version
3. Make sure it works
4. Make sure you understand it
5. Modify it to make it more complicated
6. Repeat until finished

## Debugging

Manual Debugging Strategy

* How do we figure out what's wrong with a program?
    * Be a scientist.
        * Hypothesize about what is wrong.
        * Make one change that is expected to fix error.
        * Check if change worked/fixed error.
    * **Do not change something without a reason.**
    * Developing hypotheses (observe)
      * See where the code failed.
      * Read the error message.
      * Observe what the code is doing.
        * Look at the current state of the environment (snapshot of what's going on)
        * Talk through the code.
        * [Rubber duck programming](https://en.wikipedia.org/wiki/Rubber_duck_debugging)
    * Run the code line by line checking each step.
    * Have a LLM look for problems

### Example

* Create a file with the following code in it
* Run it
* Work through debugging the code

```{r}
library(dplyr)

surveys <- read.csv('surveys.csv')
species <- read.csv('species.csv')

do_counts_by_year <- survey |>
  filter(species = "DO") |>
  group_by(year)
  summarize(count = n())

ggplot(do_count_by_year, aes(x = year, y = count)) +
  geom_point() +
  geom_line()
  labs(x = "Year", y = "Count")
```

### Debugged version of example

```{r}
library(dplyr)
library(ggplot2)

surveys <- read.csv('surveys.csv')

do_counts_by_year <- surveys |>
  filter(species_id == "DO") |>
  group_by(year) |>
  summarize(count = n())

ggplot(do_counts_by_year, aes(x = year, y = count)) +
  geom_point() +
  geom_line() +
  labs(x = "Year", y = "Count") 
```

* Now copy the code into a LLM and see what it finds and what it gets wrong




## Introduction to Reproducibility

* Goal - rerun full analysis with a single click (or command)
* First step - Make sure your code runs anytime and anywhere
  * next day (who has gotten code working & had it not work the next day?)
	* desktop vs. laptop
	* collaborators
	* advisor

### Setup

> Make sure that `Tools` -> `Global Options` -> `General` ->
> `Save workspace to ~/.RData on exit` is set to the default `Ask`


### Make sure things you did before don't matter

* Computers store the results of each command run in sequence
* Change something
* Looks like it still works
* Only works because of something you did earlier in the same session

### Clearing environments and restarting R

* Clear R environment using the broom icon on the `Environment` tab.
  * Doesn't unload packages
  * Useful when developing code
* Restart R to get a clean environment
  * Works locally (not in Posit Cloud; `Session` -> `Restart R` always reloads environment)
  * Does unload packages
  * Useful for making sure everything works
  * As long is it doesn't secretly reload things
* Run entire file using `Source` button or `Ctrl-Shift-S`
* Makes sure that the code runs fully and produces desired result

* Stop R from storing the state of the environment
* When you close RStudio it will often ask if you want to save your workspace
* *Start to close RStudio*
* *Show Save dialog*
* Or on Posit Cloud it will just do this automatically
* If you do this is will get reloaded when you start R, even when you restart it
  as described above
* Stop this by `Tools` -> `Global Options` -> `General` ->
  `Save workspace to ~/.RData on exit` -> `Never`
* Unclick `Restore .RData into workspace at startup` 

### Make sure code works on other computers

* Don't use `setwd()`
    * Use projects and relative paths
    * `data/mydata.csv` not `C:\Users\Batman\DataCarp\data\mydata.csv`
* Write code that works on all operating systems
    * Filenames in code should match actual names exactly, including capitalization
    * Use `/` instead of `\` or `\\` in paths

### Clean up extra code

* Remove experiments from your code
* Or at least comment them out
* Remove `install.packages()` lines from your code
* Avoid reinstalling packages repeatedly

### Checklist

* There is an Assignment Turn In Checklist to help
* Show link on main page

## Finding Help

* Professional programmers use Google regularly
* Learning how to search, read, and apply online help is a key skill

> * Ask students for something they want to search
> * Demo searching for an answer
> * Highlighting points below

### Tips

#### Search

* Get the vocabulary right
* Avoid extra words
* Specify the language

#### Results

##### Help sites

* Read the question
* Look at the setup
* Check the age
* Check the top 2-3 answers
* Glance at the comments
* Test & modify the example
    * But don't blindly paste things you don't understand
    * Reputation can help - e.g., StackOverflow w/lots of positive votes

##### Blog posts

* Read the question
* Look at the setup
* Use `Find`

##### Documentation

* Use `Find`
* Focus on the examples

#### Testing and modifying answers

* Test the example
* Modify the example
* But be careful
    * Malicious code examples exist
    * Do you trust the site
    * Does it have a lot of upvotes
    * Top of searches with lots of hits