---
title: 'Week 2: Intro to R'
author: "Ellen Bledsoe"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Logging into Posit Cloud

-   Open a browser
-   Go to <https://posit.cloud/>
-   ...

### R

-   Programming language
-   Started as a statistics and data analysis environment
-   But can also build websites, run simulations, and lots of other things
-   R is what runs all of the code we will write this semester
-   Separate from RStudio

### RStudio

-   IDE - Integrated Development Environment
-   Makes developing code in R easier by including a number of tools in one place
-   Interpreter/Console is where R is actually running
    -   Can work in here "interactively"
    -   Run a single command and see the result
    -   `2 + 2`
    -   This is also where RStudio will run code written in the text editor
-   Text editor
    -   Where we write code we want to keep and potentially reuse later
    -   Creates a plain text file that stores the code we've written
    -   We can open it by clicking the `New File` button or using the `Ctrl-Shift-N` keyboard shortcut (`Cmd-Shift-N`) on Mac

### Posit Cloud

-   An online version of RStudio that runs in your browser
-   We're using it because it:
    1.  Avoids installation difficulties
    2.  Makes sharing code with instructors for debugging easier
    3.  Let's us leave some of the complexities of working with R until after we've learned the basics
-   Folks with limited internet access, please checkout the video on working with RStudio installed on your own computer

#### Posit Cloud in Class

-   All work for this class will be done in a class workspace
-   To join this space follow the link provided via Canvas and sign in using your UF email address
-   When you open Posit Cloud click on the three lines in the top corner and select `Data Carpentry` from `Spaces`
-   Click on the appropriate week, which should say `Start` by it the first time you open it
-   This is your own copy of the assignment, which should include everything you need to both follow along with the lessons and complete the assignment
-   This is also where we can come look at your code to help if you get stuck
-   If you want to start a separate project, not for class, just click on `New Project` instead

### Basic expressions

-   *Write code directly in the text editor*
-   Kangaroo rat weight (g -\> lb)

```{r}
50 / 1000 * 2.2
```

-   This is called an expression

-   A set of commands that returns a value

-   Run line

-   Run selection

-   `Source` & `Source with Echo`

-   Save as `krat_weight_analysis.R`

-   Can see in the `Files` tab that we've created this file

-   We can also use this tab to create, delete, and rename files & folders

### Variables

-   To save the values we calculate for later use we use variables
-   A variable is a name that has a value associated with it
    -   Assign using `<-` or `=`

```{r}
weight_g <- 50
weight_g = 50
```

-   We can see that this variable has been created by looking in the Environment tab

-   It works just like the value itself

```{r}
weight_g / 1000
weight_g / 1000 * 2.2
weight_lb <- weight_g / 1000 * 2.2
```

-   It won't change unless you assign a new value to it directly

```{r}
weight_g
weight_g * 2
weight_g
weight_g <- 26
weight_g
```

### RStudio tips

-   `tab` key autocompletes
    -   *Type `wei` and then tab*
    -   Let the computer do repetitious work.
    -   It's easier and with fewer mistakes.
-   And a history of the commands you've run under `History` in case you forgot to write something down

### Comments

-   Remember what code is doing
-   For humans, not computers
-   Use the `#`

```{r}
# Calculate weight of Kangaroo Rat in pounds
```

### Assignments format

-   Comment before each problem and each sub-problem
-   Make sure result prints out on `Source with echo`

```{r}
# Exercise 1

# 1.1
2 + 2

# 1.2
2 - 8
```

-   Now we're going to work on some exercises to get a feel for this
-   In class we will often only do part of an exercise and save the rest for later

Do Exercises 1 and 2 in the Assignment.

### Functions

-   A function is a complicated expression.
-   Command that returns a value

```{r}
sqrt(49)
```

-   A function call is composed of two parts.
    -   Name of the function
    -   Arguments that the function requires to calculate the value it returns.
    -   `sqrt()` is the name of the function, and `49` is the argument.
-   We can also pass variables as the argument

```{r}
weight_lb <- 0.11
sqrt(weight_lb)
```

-   Another function that we'll use a lot is `str()`
-   All values and therefore all variables have types
-   `str`, short for "structure", lets us look at them

```{r}
str(weight_lb)
```

-   Another data type is for text data
-   We write text inside of quotation makes

```{r}
"hello world"
```

-   If we look at the structure of some text we see that it is type character

```{r}
str("hello world")
```

-   Functions can take multiple arguments.
    -   Round `weight_lb` to one decimal place
    -   Typing `round()` shows there are two arguments
    -   Number to be rounded and number of digits

```{r}
round(weight_lb, 1)
```

-   Functions return values, so as with other values and expressions, if we don't save the output of a function then there is no way to access it later
-   It is common to forget this when dealing with functions and expect the function to have changed the value of the variable
-   But looking at `weight_lb` we see that it hasn't been rounded

```{r}
weight_lb
```

-   To save the output of a function we assign it to a variable.

```{r}
weight_rounded <- round(weight_lb, 1)
weight_rounded
```

Start working on Exercise 4.

## Vectors

### Vectors Basics

-   Remember that all values in R have a type
-   A vector is a sequence of values that all have the same type
-   Create using the `c()` function, which stands for "combine"

```{r}
states <- c("FL", "FL", "GA", "SC")
```

-   Using the `str` function we learned last time shows that this is a vector of 4 character strings

```{r}
str(states)
```

### Subsetting 

-   Use square brackets `[]`

-   In general `[]` in R means, "give me a piece of something"

#### Subsetting by Index

-   `states[1]` gives us the first value in the vector

-   `states[1:3]` gives us the first through the third values

-   `1:3` works by making a vector of the whole numbers 1 through 3.

-   So, this is the same as `states[1:3]` is the same as `states[c(1, 2, 3)]`

-   You can use a vector to get any subset or order you want `states[c(4, 1, 3)]`

-   Many functions in R take a vector as input and return a value

-   This includes the function `length` which determines how many items are in a vector

```{r}
length(states)
```

-   We can also calculate common summary statistics
-   For example, if we have a vector of population counts

```{r}
count <- c(9, 16, 3, 10)
mean(count)
max(count)
min(count)
sum(count)
```

Work on Question 6.

### Null Values

-   So far we've worked with vectors that contain no missing values
-   But most real world data has values that are missing for a variety of reasons
-   For example, kangaroo rats don't like being caught by humans and are pretty good at escaping before you've finished measuring them
-   Missing values, known as "null" values, are written in R as `NA` with no quotes, which is short for "not available"
-   So a vector of 4 population counts with the third value missing would look like

```{r}
count_na <- c(9, 16, NA, 10)
```

-   If we try to take the mean of this vector we get `NA`?

```{r}
mean(count_na)
```

-   Hard to say what a calculation including `NA` should be
-   So most calculations return `NA` when `NA` is in the data
-   Can tell many functions to remove the `NA` before calculating
-   Do this using an optional argument, which is an argument that we don't have to include unless we want to modify the default behavior of the function
-   Add optional arguments by providing their name (`na.rm`), `=`, and the value that we want those arguments to take (`TRUE`)

```{r}
mean(count_na, na.rm = TRUE)
```

Work on Question 7.

### Working with Multiple Vectors

-   Build on example where we have information on states and population counts by adding areas

```{r}
states <- c("FL", "FL", "GA", "SC")
count <- c(9, 16, 3, 10)
area <- c(3, 5, 1.9, 2.7)
```

#### Vector Math

-   Perform the same mathematical operation on each value in a vector by treating it like we would a single value
-   So if we wanted to double all of the values in the `area` vector

```{r}
area * 2
```

-   This works because when do this multiplication, R multiplies the first value in the vector by 2, then multiplies the second values in the vector by 2, and so on

-   Element-wise: operating on one element at a time

-   Remember - this isn't saved unless we store it

-   So `area` hasn't changed

```{r}
area
```

-   If we want to keep the results of the calculation them in a new variable

```{r}
doubled_area <- area * 2
doubled_area
```

-   We can also do element-wise math with multiple vectors of the same length
-   Let's divide the count vector by the area vector to get a vector of the density of individuals in that area

```{r}
density <- count / area
```

-   When we divide the two vectors, R divides the first value in the first vector by the first value in the second vector, then divides the second values in each vector, and so on
-   Element-wise: operating on one element at a time

#### Conditional Subsetting

-   Subsetting or "filtering" is done using `[]`
-   Like with slicing, the `[]` say "give me a piece of something"
-   Selects parts of vectors based on "conditions" not position
-   Get the density values for sites in Florida

```{r}
density[states == 'FL']
```

-   `==` is how we indicate "equal to" in most programming languages.

-   Not `=`. `=` is used for assignment.

-   Can also do "not equal to"

```{r}
density[states != 'FL']
```

-   Numerical comparisons like greater or less than
-   Select states that meet with some restrictions on density

```{r}
states[density > 3]
states[density < 3]
states[density <= 3]
```

-   Can subset a vector based on itself
-   If we want to look at the densities greater than 3
-   `density` is both the vector being subset and part of the condition

```{r}
density[density > 3]
```

Work on Question 8a-8c.

-   What's actually happening when we subset vectors this way?
-   Let's look at the piece of the code inside the `[]`

```{r}
density > 3
```

-   This does an element-wise check to see if each value is \> 3
-   If it is the result is `TRUE`, if not it is `FALSE`
-   The `density[]` part of the code then keeps those values in the `density` vector where this inner vector is `TRUE`
-   You don't need to remember this last piece now, we'll come back to it

Wrap up the Assignment by finishing up Question 8 (and the optional Question 9).
